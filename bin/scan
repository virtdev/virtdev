#!/usr/bin/python

import os
import sys
import commands
import argparse

_bin = commands.getoutput('readlink -f %s' % sys.argv[0])
_path = os.path.dirname(_bin)
_dir = os.path.dirname(_path)
sys.path.append(_dir)

from lib.api import api_scan

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('-u', dest='uid', default=None)
    parser.add_argument('-n', dest='name', default=None)
    parser.add_argument('-s', '--supernode', action='store_true')
    
    args = parser.parse_args(sys.argv[1:])
    uid = args.uid
    name = args.name
    if not uid or not name:
        parser.print_help()
        sys.exit()
    
    if args.supernode:
        from lib.util import set_supernode
        set_supernode()
    
    ret = api_scan(uid, name)
    print(str(ret))
