#!/usr/bin/python

import os
import sys
import xattr
import commands

_name = commands.getoutput('readlink -f %s' % sys.argv[0])
_path = os.path.dirname(_name)
_dir = os.path.dirname(_path)
sys.path.append(_dir)

from lib.util import cmd
from conf.path import PATH_MNT
from lib.operations import OP_CLONE

def usage():
    print('usage: clone [uid] [parent]')

if __name__ == '__main__':
    argc = len(sys.argv)
    if argc != 3:
        usage()
        sys.exit()
    uid = sys.argv[1]
    attr = {'parent':sys.argv[2]}
    path = os.path.join(PATH_MNT, uid)
    ret = xattr.getxattr(path, cmd(OP_CLONE, attr))
    print(str(ret))
